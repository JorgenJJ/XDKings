<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" media="screen" href="../css/stylesheet.css">
    <title>XDKings</title>
  </head>
  <body>
    <div id="launches"></div>
  </body>
  <script>
    const Http = new XMLHttpRequest();
    const url = 'https://launchlibrary.net/1.4/launch';
    Http.open("GET", url);
    Http.send();

    Http.onreadystatechange=function() {
      if(this.readyState==4 && this.status==200) {
        jsonParser(Http.responseText);
      }
    }

    function jsonParser(response) {
      var obj = JSON.parse(response);
      for (var i = 0; i < 10; i++) {
        var link = document.createElement('a');
        var div = document.createElement('div');
        var title = document.createElement('h3');
        title.innerHTML = obj.launches[i].name;

        var date = document.createElement('p');
        date.innerHTML = obj.launches[i].windowstart;


        var statusEl = document.createElement('p');
        var status = obj.launches[i].status;
        switch (status) {
          case 1:
            statusEl.innerHTML = "Confirmed";
            statusEl.style = "background-color: green";
            break;
          case 2:
            statusEl.innerHTML = "Not confirmed";
            statusEl.style = "background-color: red";
            break;
          default:
            statusEl.innerHTML = "Unknown";
            statusEl.style = "background-color: gray";
            break;
        }

        div.appendChild(title);
        div.appendChild(date);
        div.appendChild(statusEl);
        div.setAttribute("launchId", obj.launches[i].id);
        link.setAttribute("href", "launch.html?id=" + obj.launches[i].id);
        link.appendChild(div);
        document.getElementById("launches").appendChild(link);
      }
    }
    </script>
</html>
